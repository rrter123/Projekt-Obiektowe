require 'io/console'

class Labirynth
	def initialize
		@pos = [1,1]
		gen = Generate.new
		@lab = gen.generate
		puts "Move using WSAD"
	end
	def write
		for i in 0...@lab.length
			@lab[i].each {|a| print a}
			puts
		end
	end
	
	def look
		for j in -2...3
			for i in -2...3
				print @lab[@pos[0]+j][@pos[1]+i]
			end
			puts
		end
	end
	
	
	def up
		if @lab[@pos[0]-1][@pos[1]] == "."
			@lab[@pos[0]-1][@pos[1]] = "P"
			@lab[@pos[0]][@pos[1]] = "."
			@pos[0] -= 1
		elsif @lab[@pos[0]-1][@pos[1]] == "X"
			@pos[0] -= 1
		end
	end
	def down
		if @lab[@pos[0]+1][@pos[1]] == "."
			@lab[@pos[0]+1][@pos[1]] = "P"
			@lab[@pos[0]][@pos[1]] = "."
			@pos[0] += 1
		elsif @lab[@pos[0]+1][@pos[1]] == "X"
			@pos[0] += 1
		end
	end
	def left
		if @lab[@pos[0]][@pos[1]-1] == "."
			@lab[@pos[0]][@pos[1]-1] = "P"
			@lab[@pos[0]][@pos[1]] = "."
			@pos[1] -= 1
		elsif @lab[@pos[0]][@pos[1]-1] == "X"
			@pos[1] -= 1
		end
	end
	def right
		if @lab[@pos[0]][@pos[1]+1] == "."
			@lab[@pos[0]][@pos[1]+1] = "P"
			@lab[@pos[0]][@pos[1]] = "."
			@pos[1] += 1
		elsif @lab[@pos[0]][@pos[1]+1] == "X"
			@pos[1] += 1
		end
	end
	def movement
		key=STDIN.getch
		if key == "w" or key == "W"
			self.up
		elsif key == "s" or key == "S"
			self.down
		elsif key == "a" or key == "A"
			self.left
		elsif key == "d" or key == "D"
			self.right
		end
		self.look
		puts
		if @lab[@pos[0]][@pos[1]] == "X"
			return 1
		end
		return 0
	end
end

class Generate
	def generate
		number = rand(5)
		if number == 0
			return [["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],
					["#","P",".",".","#","#","#","#","#","#","#","#","#","#","#"],
					["#",".","#",".","#","#",".","#","#","#","#","#",".","X","#"],
					["#",".","#","#","#","#",".",".",".",".",".",".",".","#","#"],
					["#",".",".",".","#","#","#",".","#","#",".","#",".","#","#"],
					["#","#",".","#","#","#","#",".","#","#",".",".",".","#","#"],
					["#",".",".","#","#","#","#",".","#","#","#",".","#","#","#"],
					["#",".","#","#","#","#","#",".","#","#","#",".","#","#","#"],
					["#",".","#","#","#","#","#",".","#","#","#",".","#","#","#"],
					["#",".","#","#","#","#","#",".","#","#","#",".","#","#","#"],
					["#",".",".",".",".",".","#",".","#","#","#",".","#","#","#"],
					["#",".","#","#","#",".","#",".","#","#","#",".",".",".","#"],
					["#","#","#","#","#",".","#",".",".",".",".",".","#",".","#"],
					["#","#","#","#","#",".",".",".","#","#","#","#","#","#","#"],
					["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],
					["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"]]
		elsif number == 1
			return [["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],
					["#","P",".",".",".",".","#","#","#","#","#","#","#","#","#"],
					["#",".",".","#","#",".",".",".",".","#","#","#","#","#","#"],
					["#","#","#","#","#",".","#","#",".","#","#","#","#","#","#"],
					["#","#","#","#","#",".","#","#",".","#","#","#","#","#","#"],
					["#","#","#","#","#",".","#","#",".","#","#","#","#","#","#"],
					["#","#",".","#","#",".",".",".",".","#","#","#","#","#","#"],
					["#","#",".",".",".",".","#","#","#","#","#","#",".","#","#"],
					["#","#","#","#",".",".","#","#","#","#","#","#",".","#","#"],
					["#","#","#","#",".","#","#","#","#","#","#","#",".","#","#"],
					["#","#","#","#",".","#","#","#","#","#","#",".",".",".","#"],
					["#","#","#","#",".",".",".",".",".",".","#",".","#",".","#"],
					["#","#","#","#","#","#","#","#","#",".","#",".","#",".","#"],
					["#","#","#","#","#","#","#","#","#",".",".",".","#","X","#"],
					["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],
					["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"]]
		elsif number == 2
			return [["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],
					["#","P",".",".",".",".",".",".",".",".",".","#","#","#","#"],
					["#","#","#","#","#","#","#","#","#","#",".","#","#","#","#"],
					["#","#","#","#","#","#","#","#","#","#",".","#","#","#","#"],
					["#","#","#","#","#","#",".",".",".","#",".","#","#","#","#"],
					["#","#",".",".",".",".",".","#",".",".",".",".",".","#","#"],
					["#","#",".","#","#","#","#","#","#",".","#","#",".","#","#"],
					["#","#",".","#","#","#","#","#","#",".","#","#",".","#","#"],
					["#","#",".",".",".",".","#","#","#",".","#","#",".","#","#"],
					["#","#","#","#","#",".","#","#","#",".","#","#",".","#","#"],
					["#","#","#","#","#",".","#","#","#",".","#","#",".","#","#"],
					["#","#","#","#","#",".","#","#","#",".","#","#","#","#","#"],
					["#",".",".",".",".",".",".",".",".",".","#","#","#","#","#"],
					["#","X","#","#","#","#","#","#","#","#","#","#","#","#","#"],
					["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],
					["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"]]
		elsif number == 3
			return [["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],
					["#","P",".",".",".",".",".",".",".",".",".",".",".",".","#"],
					["#","#","#","#",".","#","#","#","#","#","#","#","#",".","#"],
					["#","X",".","#",".","#","#","#","#","#","#","#","#",".","#"],
					["#","#",".","#",".",".",".",".","#","#","#","#","#",".","#"],
					["#","#",".","#",".","#","#",".","#","#","#","#","#",".","#"],
					["#","#",".","#","#","#","#",".","#","#","#","#","#",".","#"],
					["#","#",".","#","#","#","#",".","#",".",".",".",".",".","#"],
					["#","#",".",".","#","#","#",".",".",".",".","#","#",".","#"],
					["#","#","#",".",".",".","#","#","#","#",".","#","#",".","#"],
					["#","#","#","#","#",".","#","#","#","#",".","#","#",".","#"],
					["#",".","#","#","#",".","#","#","#","#",".",".","#",".","#"],
					["#",".",".",".",".",".",".",".",".","#","#",".","#",".","#"],
					["#","#","#","#","#","#","#","#",".",".",".",".",".",".","#"],
					["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],
					["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"]]
		elsif number == 4
			return [["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],
					["#","P",".",".",".","#","#",".","#",".",".",".",".","#","#"],
					["#","#","#","#",".","#",".",".","#",".","#","#",".","X","#"],
					["#","#","#","#",".","#",".",".",".",".","#","#","#","#","#"],
					["#","#","#","#",".","#",".","#",".","#","#","#","#","#","#"],
					["#","#","#","#",".","#",".","#",".","#","#","#","#","#","#"],
					["#","#",".",".",".",".",".",".",".",".","#","#",".","#","#"],
					["#","#",".","#",".","#","#","#","#",".",".",".",".","#","#"],
					["#","#",".","#",".","#","#","#","#","#",".","#","#","#","#"],
					["#","#",".",".",".",".","#","#","#","#",".","#","#","#","#"],
					["#","#",".","#","#",".","#","#","#","#",".","#","#","#","#"],
					["#","#","#","#","#",".","#","#","#","#",".","#","#","#","#"],
					["#","#","#","#","#",".",".",".",".","#",".","#","#","#","#"],
					["#","#","#","#","#","#","#","#",".",".",".","#","#","#","#"],
					["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],
					["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"]]
		end
	end
end
